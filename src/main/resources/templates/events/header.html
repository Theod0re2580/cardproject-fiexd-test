<!-- header.html -->
<div th:fragment="header">
    <link rel="stylesheet" th:href="@{/css/header.css}">

    <nav class="navbar">

        <!-- LOGO -->
        <div class="nav-left">
            <a th:href="@{/}">
                <img th:src="@{/images/bi_bk_header.png}" class="logo" alt="CARDGORILLA">
            </a>
        </div>

        <!-- CENTER MENU -->
        <ul class="nav-center">
            <li><a th:href="@{/events}">브랜드별 카드 추천</a></li>
            <li><a th:href="@{/events/top}">인기 카드 TOP10</a></li>
            <li><a th:href="@{/events/benefits}">혜택별 카드 추천</a></li>

            <!-- Dropdown -->
            <li class="nav-item dropdown">
                <button type="button" class="dropdown-toggle">이색카드 추천</button>

                <ul class="dropdown-menu">
                    <li><a th:href="@{/events/random}">🎲 지금의 행운 카드</a></li>
                    <li><a th:href="@{/events/mbti}">MBTI별 카드추천</a></li>
                </ul>
            </li>
        </ul>

        <!-- RIGHT MENU -->
        <div class="nav-right">

            <!-- 로그인 X -->
            <div class="login" th:if="${session.loggedMember == null}">
                <a th:href="@{/member/login}">로그인</a>
                <a th:href="@{/member/signup}">회원가입</a>
            </div>

            <!-- 로그인 O -->
            <div class="login" th:if="${session.loggedMember != null}">
                <span th:text="${session.loggedMember.loginId + '님'}"></span>
                <a th:href="@{/member/info}">마이페이지</a>
                <a th:href="@{/member/logout}">로그아웃</a>
            </div>

            <!-- SEARCH -->
            <div class="icons">
                <input type="text" class="search">
                <button class="search-btn"><i class="fa-solid fa-magnifying-glass"></i></button>
            </div>

        </div>
    </nav>

    <!-- Dropdown Script -->
    <script th:inline="javascript">
        document.addEventListener("DOMContentLoaded", () => {
            const toggles = document.querySelectorAll(".dropdown-toggle");

            toggles.forEach(btn => {
                btn.addEventListener("click", e => {
                    e.stopPropagation();
                    const menu = btn.closest(".dropdown").querySelector(".dropdown-menu");

                    document.querySelectorAll(".dropdown-menu")
                        .forEach(m => { if (m !== menu) m.classList.remove("open"); });

                    menu.classList.toggle("open");
                });
            });

            document.addEventListener("click", () => {
                document.querySelectorAll(".dropdown-menu")
                    .forEach(m => m.classList.remove("open"));
            });
        });
    </script>

</div>
